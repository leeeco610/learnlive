!function(c){c("ul.cpc-tabs-nav li").each(function(i){var e=i;c(this).click(function(){c(this).parent().children().removeClass("active").eq(e).addClass("active"),c(".cp-tabs-box").children("div").hide().eq(e).stop(!1,!0).show()})})}(jQuery);
function change_send(){var e=document.getElementById("send_cimg");e.src="/html/FormCode.ashx?t="+(new Date).valueOf()}
/*
    Validform version 5.3
	By sean during April 7, 2010 - February 21, 2013
	For more information, please visit http://validform.rjboy.cn
	Validform is available under the terms of the MIT license.
*/
(function (d, f, b) { var g = null, j = null, i = true; var e = { tit: "提示信息", w: { "*": "不能为空！", "*6-16": "请填写6到16位任意字符！", "n": "请填写数字！", "n6-16": "请填写6到16位数字！", "s": "不能输入特殊字符！", "s6-18": "请填写6到18位字符！", "p": "请填写邮政编码！", "m": "请填写手机号码！", "e": "邮箱地址格式不对！", "url": "请填写网址！" }, def: "请填写正确信息！", undef: "datatype未定义！", reck: "两次输入的内容不一致！", r: "", c: "正在检测信息…", s: "请{填写|选择}{0|信息}！", v: "所填信息没有经过验证，请稍后…", p: "正在提交数据…" }; d.Tipmsg = e; var a = function (l, n, k) { var n = d.extend({}, a.defaults, n); n.datatype && d.extend(a.util.dataType, n.datatype); var m = this; m.tipmsg = { w: {} }; m.settings = n; m.forms = l; m.objects = []; if (k === true) { return false } l.each(function () { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; var o = d(this); this.validform_status = "normal"; this.validform_label = n.label; o.data("tipmsg", m.tipmsg); o.delegate("[datatype]", "blur", function () { var p = arguments[1]; a.util.check.call(this, o, m, p) }); a.util.enhance.call(o, n.tiptype, n.usePlugin, n.tipSweep); n.btnSubmit && o.find(n.btnSubmit).bind("click", function () { o.trigger("submit"); return false }); o.submit(function () { var p = a.util.submitForm.call(o, n); p === b && (p = true); return p }); o.find("[type='reset']").add(o.find(n.btnReset)).bind("click", function () { a.util.resetForm.call(o) }) }); if (n.tiptype == 1 || (n.tiptype == 2 || n.tiptype == 3) && n.ajaxPost) { c() } }; a.defaults = { tiptype: 1, tipSweep: false, showAllError: false, postonce: false, ajaxPost: false }; a.util = { dataType: { "*": /[\w\W]+/, "*6-16": /^[\w\W]{6,16}$/, n: /^\d+$/, "n6-16": /^\d{6,16}$/, s: /^[\u4E00-\u9FA5\uf900-\ufa2d\w\.\s]+$/, "s6-18": /^[\u4E00-\u9FA5\uf900-\ufa2d\w\.\s]{6,18}$/, p: /^[0-9]{6}$/, m: /^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/, e: /^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/, url: /^(\w+:\/\/)?\w+(\.\w+)+.*$/ }, toString: Object.prototype.toString, isEmpty: function (k) { return k === "" || k === d.trim(this.attr("tip")) }, getValue: function (m) { var l, k = this; if (m.is(":radio")) { l = k.find(":radio[name='" + m.attr("name") + "']:checked").val(); l = l === b ? "" : l } else { if (m.is(":checkbox")) { l = ""; k.find(":checkbox[name='" + m.attr("name") + "']:checked").each(function () { l += d(this).val() + "," }); l = l === b ? "" : l } else { l = m.val() } } l = d.trim(l); return a.util.isEmpty.call(m, l) ? "" : l }, enhance: function (l, m, n, k) { var o = this; o.find("[datatype]").each(function () { if (l == 2) { if (d(this).parent().next().find(".Validform_checktip").length == 0) { d(this).parent().next().append("<span class='Validform_checktip' />") } } else { if (l == 3 || l == 4) { if (d(this).siblings(".Validform_checktip").length == 0) { d(this).parent().append("<span class='Validform_checktip' />") } } } }); o.find("input[recheck]").each(function () { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; var q = d(this); var p = o.find("input[name='" + d(this).attr("recheck") + "']"); p.bind("keyup", function () { if (p.val() == q.val() && p.val() != "") { if (p.attr("tip")) { if (p.attr("tip") == p.val()) { return false } } q.trigger("blur") } }).bind("blur", function () { if (p.val() != q.val() && q.val() != "") { if (q.attr("tip")) { if (q.attr("tip") == q.val()) { return false } } q.trigger("blur") } }) }); o.find("[tip]").each(function () { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; var q = d(this).attr("tip"); var p = d(this).attr("altercss"); d(this).focus(function () { if (d(this).val() == q) { d(this).val(""); if (p) { d(this).removeClass(p) } } }).blur(function () { if (d.trim(d(this).val()) === "") { d(this).val(q); if (p) { d(this).addClass(p) } } }) }); o.find(":checkbox[datatype],:radio[datatype]").each(function () { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; var q = d(this); var p = q.attr("name"); o.find("[name='" + p + "']").filter(":checkbox,:radio").bind("click", function () { setTimeout(function () { q.trigger("blur") }, 0) }) }); o.find("select[datatype][multiple]").bind("click", function () { var p = d(this); setTimeout(function () { p.trigger("blur") }, 0) }); a.util.usePlugin.call(o, m, l, n, k) }, usePlugin: function (o, l, n, r) { var s = this, o = o || {}; if (s.find("input[plugin='swfupload']").length && typeof (swfuploadhandler) != "undefined") { var k = { custom_settings: { form: s, showmsg: function (v, t, u) { a.util.showmsg.call(s, v, l, { obj: s.find("input[plugin='swfupload']"), type: t, sweep: n }) } } }; k = d.extend(true, {}, o.swfupload, k); s.find("input[plugin='swfupload']").each(function (t) { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; d(this).val(""); swfuploadhandler.init(k, t) }) } if (s.find("input[plugin='datepicker']").length && d.fn.datePicker) { o.datepicker = o.datepicker || {}; if (o.datepicker.format) { Date.format = o.datepicker.format; delete o.datepicker.format } if (o.datepicker.firstDayOfWeek) { Date.firstDayOfWeek = o.datepicker.firstDayOfWeek; delete o.datepicker.firstDayOfWeek } s.find("input[plugin='datepicker']").each(function (t) { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; o.datepicker.callback && d(this).bind("dateSelected", function () { var u = new Date(d.event._dpCache[this._dpId].getSelected()[0]).asString(Date.format); o.datepicker.callback(u, this) }); d(this).datePicker(o.datepicker) }) } if (s.find("input[plugin*='passwordStrength']").length && d.fn.passwordStrength) { o.passwordstrength = o.passwordstrength || {}; o.passwordstrength.showmsg = function (u, v, t) { a.util.showmsg.call(s, v, l, { obj: u, type: t, sweep: n }) }; s.find("input[plugin='passwordStrength']").each(function (t) { if (this.validform_inited == "inited") { return true } this.validform_inited = "inited"; d(this).passwordStrength(o.passwordstrength) }) } if (r != "addRule" && o.jqtransform && d.fn.jqTransSelect) { var m = function (t) { var u = d(".jqTransformSelectWrapper ul:visible"); u.each(function () { var v = d(this).parents(".jqTransformSelectWrapper:first").find("select").get(0); if (!(t && v.oLabel && v.oLabel.get(0) == t.get(0))) { d(this).hide() } }) }; var p = function (t) { if (d(t.target).parents(".jqTransformSelectWrapper").length === 0) { m(d(t.target)) } }; var q = function () { d(document).mousedown(p) }; if (o.jqtransform.selector) { s.find(o.jqtransform.selector).filter('input:submit, input:reset, input[type="button"]').jqTransInputButton(); s.find(o.jqtransform.selector).filter("input:text, input:password").jqTransInputText(); s.find(o.jqtransform.selector).filter("input:checkbox").jqTransCheckBox(); s.find(o.jqtransform.selector).filter("input:radio").jqTransRadio(); s.find(o.jqtransform.selector).filter("textarea").jqTransTextarea(); if (s.find(o.jqtransform.selector).filter("select").length > 0) { s.find(o.jqtransform.selector).filter("select").jqTransSelect(); q() } } else { s.jqTransform() } s.find(".jqTransformSelectWrapper").find("li a").click(function () { d(this).parents(".jqTransformSelectWrapper").find("select").trigger("blur") }) } }, getNullmsg: function (o) { var n = this; var m = /[\u4E00-\u9FA5\uf900-\ufa2da-zA-Z\s]+/g; var k; var l = o[0].validform_label || ".Validform_label"; l = n.siblings(l).text() || n.siblings().find(l).text() || n.parent().siblings(l).text() || n.parent().siblings().find(l).text(); l = l.match(m) || [""]; m = /\{(.+)\|(.+)\}/; k = o.data("tipmsg").s || e.s; l = l[0].replace(/\s(?![a-zA-Z])/g, ""); if (l != "") { k = k.replace(/\{0\|(.+)\}/, l); if (n.attr("recheck")) { k = k.replace(/\{(.+)\}/, ""); n.attr("nullmsg", k); return k } } else { k = n.is(":checkbox,:radio,select") ? k.replace(/\{0\|(.+)\}/, "") : k.replace(/\{0\|(.+)\}/, "$1") } k = n.is(":checkbox,:radio,select") ? k.replace(m, "$2") : k.replace(m, "$1"); n.attr("nullmsg", k); return k }, getErrormsg: function (s, o, u) { var n = this; var p = /^(.+?)((\d+)-(\d+))?$/, m = /^(.+?)(\d+)-(\d+)$/, l = /(.*?)\d+(.+?)\d+(.*)/, q = o.match(p), t, r; if (u == "recheck") { r = s.data("tipmsg").reck || e.reck; return r } if (q[0] in e.w) { return s.data("tipmsg").w[q[0]] || e.w[q[0]] } for (var k in e.w) { if (k.indexOf(q[1]) != -1 && m.test(k)) { r = (s.data("tipmsg").w[k] || e.w[k]).replace(l, "$1" + q[3] + "$2" + q[4] + "$3"); e.w[q[0]] = r; return r } } return s.data("tipmsg").def || e.def }, _regcheck: function (t, n, u, A) { var A = A, y = null, v = false, o = /\/.+\//g, k = /^(.+?)(\d+)-(\d+)$/, l = 3; if (o.test(t)) { var s = t.match(o)[0].slice(1, -1); var r = t.replace(o, ""); var q = RegExp(s, r); v = q.test(n) } else { if (a.util.toString.call(a.util.dataType[t]) == "[object Function]") { v = a.util.dataType[t](n, u, A, a.util.dataType); if (v === true || v === b) { v = true } else { y = v; v = false } } else { if (!(t in a.util.dataType)) { var m = t.match(k), z; if (!m) { v = false; y = A.data("tipmsg").undef || e.undef } else { for (var B in a.util.dataType) { z = B.match(k); if (!z) { continue } if (m[1] === z[1]) { var w = a.util.dataType[B].toString(), r = w.match(/\/[mgi]*/g)[1].replace("/", ""), x = new RegExp("\\{" + z[2] + "," + z[3] + "\\}", "g"); w = w.replace(/\/[mgi]*/g, "/").replace(x, "{" + m[2] + "," + m[3] + "}").replace(/^\//, "").replace(/\/$/, ""); a.util.dataType[t] = new RegExp(w, r); break } } } } if (a.util.toString.call(a.util.dataType[t]) == "[object RegExp]") { v = a.util.dataType[t].test(n) } } } if (v) { l = 2; y = u.attr("sucmsg") || A.data("tipmsg").r || e.r; if (u.attr("recheck")) { var p = A.find("input[name='" + u.attr("recheck") + "']:first"); if (n != p.val()) { v = false; l = 3; y = u.attr("errormsg") || a.util.getErrormsg.call(u, A, t, "recheck") } } } else { y = y || u.attr("errormsg") || a.util.getErrormsg.call(u, A, t); if (a.util.isEmpty.call(u, n)) { y = u.attr("nullmsg") || a.util.getNullmsg.call(u, A) } } return { passed: v, type: l, info: y } }, regcheck: function (n, s, m) { var t = this, k = null, l = false, r = 3; if (m.attr("ignore") === "ignore" && a.util.isEmpty.call(m, s)) { if (m.data("cked")) { k = "" } return { passed: true, type: 4, info: k } } m.data("cked", "cked"); var u = a.util.parseDatatype(n); var q; for (var p = 0; p < u.length; p++) { for (var o = 0; o < u[p].length; o++) { q = a.util._regcheck(u[p][o], s, m, t); if (!q.passed) { break } } if (q.passed) { break } } return q }, parseDatatype: function (r) { var q = /\/.+?\/[mgi]*(?=(,|$|\||\s))|[\w\*-]+/g, o = r.match(q), p = r.replace(q, "").replace(/\s*/g, "").split(""), l = [], k = 0; l[0] = []; l[0].push(o[0]); for (var s = 0; s < p.length; s++) { if (p[s] == "|") { k++; l[k] = [] } l[k].push(o[s + 1]) } return l }, showmsg: function (n, l, m, k) { if (n == b) { return } if (k == "bycheck" && m.sweep && (m.obj && !m.obj.is(".Validform_error") || typeof l == "function")) { return } d.extend(m, { curform: this }); if (typeof l == "function") { l(n, m, a.util.cssctl); return } if (l == 1 || k == "byajax" && l != 4) { j.find(".Validform_info").html(n) } if (l == 1 && k != "bycheck" && m.type != 2 || k == "byajax" && l != 4) { i = false; j.find(".iframe").css("height", j.outerHeight()); j.show(); h(j, 100) } if (l == 2 && m.obj) { m.obj.parent().next().find(".Validform_checktip").html(n); a.util.cssctl(m.obj.parent().next().find(".Validform_checktip"), m.type) } if ((l == 3 || l == 4) && m.obj) { m.obj.siblings(".Validform_checktip").html(n); a.util.cssctl(m.obj.siblings(".Validform_checktip"), m.type) } }, cssctl: function (l, k) { switch (k) { case 1: l.removeClass("Validform_right Validform_wrong").addClass("Validform_checktip Validform_loading"); break; case 2: l.removeClass("Validform_wrong Validform_loading").addClass("Validform_checktip Validform_right"); break; case 4: l.removeClass("Validform_right Validform_wrong Validform_loading").addClass("Validform_checktip"); break; default: l.removeClass("Validform_right Validform_loading").addClass("Validform_checktip Validform_wrong") } }, check: function (w, r, u, n) { var o = r.settings; var u = u || ""; var k = a.util.getValue.call(w, d(this)); if (o.ignoreHidden && d(this).is(":hidden") || d(this).data("dataIgnore") === "dataIgnore") { return true } if (o.dragonfly && !d(this).data("cked") && a.util.isEmpty.call(d(this), k) && d(this).attr("ignore") != "ignore") { return false } var t = a.util.regcheck.call(w, d(this).attr("datatype"), k, d(this)); if (k == this.validform_lastval && !d(this).attr("recheck") && u == "") { return t.passed ? true : false } this.validform_lastval = k; var s; g = s = d(this); if (!t.passed) { a.util.abort.call(s[0]); if (!n) { a.util.showmsg.call(w, t.info, o.tiptype, { obj: d(this), type: t.type, sweep: o.tipSweep }, "bycheck"); !o.tipSweep && s.addClass("Validform_error") } return false } var q = d(this).attr("ajaxurl"); if (q && !a.util.isEmpty.call(d(this), k) && !n) { var m = d(this); if (u == "postform") { m[0].validform_subpost = "postform" } else { m[0].validform_subpost = "" } if (m[0].validform_valid === "posting" && k == m[0].validform_ckvalue) { return "ajax" } m[0].validform_valid = "posting"; m[0].validform_ckvalue = k; a.util.showmsg.call(w, r.tipmsg.c || e.c, o.tiptype, { obj: m, type: 1, sweep: o.tipSweep }, "bycheck"); a.util.abort.call(s[0]); var v = w[0].validform_config || {}; v = v.ajaxurl || {}; var p = { type: "POST", cache: false, url: q, data: "param=" + encodeURIComponent(k) + "&name=" + encodeURIComponent(d(this).attr("name")), success: function (y) { if (d.trim(y.status) === "y") { m[0].validform_valid = "true"; y.info && m.attr("sucmsg", y.info); a.util.showmsg.call(w, m.attr("sucmsg") || r.tipmsg.r || e.r, o.tiptype, { obj: m, type: 2, sweep: o.tipSweep }, "bycheck"); s.removeClass("Validform_error"); g = null; if (m[0].validform_subpost == "postform") { w.trigger("submit") } } else { m[0].validform_valid = y.info; a.util.showmsg.call(w, y.info, o.tiptype, { obj: m, type: 3, sweep: o.tipSweep }); s.addClass("Validform_error") } s[0].validform_ajax = null }, error: function (y) { if (y.status == "200") { if (y.responseText == "y") { v.success({ status: "y" }) } else { v.success({ status: "n", info: y.responseText }) } return false } if (y.statusText !== "abort") { var z = "status: " + y.status + "; statusText: " + y.statusText; a.util.showmsg.call(w, z, o.tiptype, { obj: m, type: 3, sweep: o.tipSweep }); s.addClass("Validform_error") } m[0].validform_valid = y.statusText; s[0].validform_ajax = null; return true } }; if (v.success) { var x = v.success; v.success = function (y) { p.success(y); x(y, m) } } if (v.error) { var l = v.error; v.error = function (y) { p.error(y) && l(y, m) } } v = d.extend({}, p, v, { dataType: "json" }); s[0].validform_ajax = d.ajax(v); return "ajax" } else { if (q && a.util.isEmpty.call(d(this), k)) { a.util.abort.call(s[0]); s[0].validform_valid = "true" } } if (!n) { a.util.showmsg.call(w, t.info, o.tiptype, { obj: d(this), type: t.type, sweep: o.tipSweep }, "bycheck"); s.removeClass("Validform_error") } g = null; return true }, submitForm: function (p, l, k, s, u) { var x = this; if (x[0].validform_status === "posting") { return false } if (p.postonce && x[0].validform_status === "posted") { return false } var w = p.beforeCheck && p.beforeCheck(x); if (w === false) { return false } var t = true, o; x.find("[datatype]").each(function () { if (l) { return false } if (p.ignoreHidden && d(this).is(":hidden") || d(this).data("dataIgnore") === "dataIgnore") { return true } var A = a.util.getValue.call(x, d(this)), B; g = B = d(this); o = a.util.regcheck.call(x, d(this).attr("datatype"), A, d(this)); if (!o.passed) { a.util.showmsg.call(x, o.info, p.tiptype, { obj: d(this), type: o.type, sweep: p.tipSweep }); B.addClass("Validform_error"); if (!p.showAllError) { B.focus(); t = false; return false } t && (t = false); return true } if (d(this).attr("ajaxurl") && !a.util.isEmpty.call(d(this), A)) { if (this.validform_valid !== "true") { var z = d(this); a.util.showmsg.call(x, x.data("tipmsg").v || e.v, p.tiptype, { obj: z, type: 3, sweep: p.tipSweep }); B.addClass("Validform_error"); z.trigger("blur", ["postform"]); if (!p.showAllError) { t = false; return false } t && (t = false); return true } } else { if (d(this).attr("ajaxurl") && a.util.isEmpty.call(d(this), A)) { a.util.abort.call(this); this.validform_valid = "true" } } a.util.showmsg.call(x, o.info, p.tiptype, { obj: d(this), type: o.type, sweep: p.tipSweep }); B.removeClass("Validform_error"); g = null }); if (p.showAllError) { x.find(".Validform_error:first").focus() } if (t) { var r = p.beforeSubmit && p.beforeSubmit(x); if (r === false) { return false } x[0].validform_status = "posting"; var m = x[0].validform_config || {}; if (p.ajaxPost || s === "ajaxPost") { var v = m.ajaxpost || {}; v.url = k || v.url || m.url || x.attr("action"); v.success || v.error || a.util.showmsg.call(x, x.data("tipmsg").p || e.p, p.tiptype, { obj: x, type: 1, sweep: p.tipSweep }, "byajax"); if (u) { v.async = false } else { if (u === false) { v.async = true } } if (v.success) { var y = v.success; v.success = function (z) { p.callback && p.callback(z); x[0].validform_ajax = null; if (d.trim(z.status) === "y") { x[0].validform_status = "posted" } else { x[0].validform_status = "normal" } y(z, x) } } if (v.error) { var n = v.error; v.error = function (z) { p.callback && p.callback(z); x[0].validform_status = "normal"; x[0].validform_ajax = null; n(z, x) } } var q = { type: "POST", async: true, data: x.serializeArray(), success: function (z) { if (d.trim(z.status) === "y") { x[0].validform_status = "posted"; a.util.showmsg.call(x, z.info, p.tiptype, { obj: x, type: 2, sweep: p.tipSweep }, "byajax") } else { x[0].validform_status = "normal"; a.util.showmsg.call(x, z.info, p.tiptype, { obj: x, type: 3, sweep: p.tipSweep }, "byajax") } p.callback && p.callback(z); x[0].validform_ajax = null }, error: function (z) { var A = "status: " + z.status + "; statusText: " + z.statusText; a.util.showmsg.call(x, A, p.tiptype, { obj: x, type: 3, sweep: p.tipSweep }, "byajax"); p.callback && p.callback(z); x[0].validform_status = "normal"; x[0].validform_ajax = null } }; v = d.extend({}, q, v, { dataType: "json" }); x[0].validform_ajax = d.ajax(v) } else { if (!p.postonce) { x[0].validform_status = "normal" } var k = k || m.url; if (k) { x.attr("action", k) } return p.callback && p.callback(x) } } return false }, resetForm: function () { var k = this; k.each(function () { this.reset(); this.validform_status = "normal" }); k.find(".Validform_right").text(""); k.find(".passwordStrength").children().removeClass("bgStrength"); k.find(".Validform_checktip").removeClass("Validform_wrong Validform_right Validform_loading"); k.find(".Validform_error").removeClass("Validform_error"); k.find("[datatype]").removeData("cked").removeData("dataIgnore").each(function () { this.validform_lastval = null }); k.eq(0).find("input:first").focus() }, abort: function () { if (this.validform_ajax) { this.validform_ajax.abort() } } }; d.Datatype = a.util.dataType; a.prototype = { dataType: a.util.dataType, eq: function (l) { var k = this; if (l >= k.forms.length) { return null } if (!(l in k.objects)) { k.objects[l] = new a(d(k.forms[l]).get(), k.settings, true) } return k.objects[l] }, resetStatus: function () { var k = this; d(k.forms).each(function () { this.validform_status = "normal" }); return this }, setStatus: function (k) { var l = this; d(l.forms).each(function () { this.validform_status = k || "posting" }); return this }, getStatus: function () { var l = this; var k = d(l.forms)[0].validform_status; return k }, ignore: function (k) { var l = this; var k = k || "[datatype]"; d(l.forms).find(k).each(function () { d(this).data("dataIgnore", "dataIgnore").removeClass("Validform_error") }); return this }, unignore: function (k) { var l = this; var k = k || "[datatype]"; d(l.forms).find(k).each(function () { d(this).removeData("dataIgnore") }); return this }, addRule: function (n) { var m = this; var n = n || []; for (var l = 0; l < n.length; l++) { var p = d(m.forms).find(n[l].ele); for (var k in n[l]) { k !== "ele" && p.attr(k, n[l][k]) } } d(m.forms).each(function () { var o = d(this); a.util.enhance.call(o, m.settings.tiptype, m.settings.usePlugin, m.settings.tipSweep, "addRule") }); return this }, ajaxPost: function (k, m, l) { var n = this; if (n.settings.tiptype == 1 || n.settings.tiptype == 2 || n.settings.tiptype == 3) { c() } a.util.submitForm.call(d(n.forms[0]), n.settings, k, l, "ajaxPost", m); return this }, submitForm: function (k, l) { var n = this; var m = a.util.submitForm.call(d(n.forms[0]), n.settings, k, l); m === b && (m = true); if (m === true) { n.forms[0].submit() } return this }, resetForm: function () { var k = this; a.util.resetForm.call(d(k.forms)); return this }, abort: function () { var k = this; d(k.forms).each(function () { a.util.abort.call(this) }); return this }, check: function (m, k) { var k = k || "[datatype]", o = this, n = d(o.forms), l = true; n.find(k).each(function () { a.util.check.call(this, n, o, "", m) || (l = false) }); return l }, config: function (k) { var l = this; k = k || {}; d(l.forms).each(function () { this.validform_config = d.extend(true, this.validform_config, k) }); return this } }; d.fn.Validform = function (k) { return new a(this, k) }; function h(n, m) { var l = (d(window).width() - n.outerWidth()) / 2, k = (d(window).height() - n.outerHeight()) / 2, k = (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + (k > 0 ? k : 0); n.css({ left: l }).animate({ top: k }, { duration: m, queue: false }) } function c() { if (d("#Validform_msg").length !== 0) { return false } j = d('<div id="Validform_msg"><div class="Validform_title">' + e.tit + '<a class="Validform_close" href="javascript:void(0);">&chi;</a></div><div class="Validform_info"></div><div class="iframe"><iframe frameborder="0" scrolling="no" height="100%" width="100%"></iframe></div></div>').appendTo("body"); j.find("a.Validform_close").click(function () { j.hide(); i = true; if (g) { g.focus().addClass("Validform_error") } return false }).focus(function () { this.blur() }); d(window).bind("scroll resize", function () { !i && h(j, 400) }) } d.Showmsg = function (k) { c(); a.util.showmsg.call(f, k, 1, {}) }; d.Hidemsg = function () { j.hide(); i = true } })(jQuery, window);
/* jqModal - Minimalist Modaling with jQuery*/
function Send(n, t, e) { $("a.order").attr("user", t), $("a.order").attr("email", n), $("a.order").attr("eurl", window.location.href), $("a.order").attr("ecityid", e), $("a.order").trigger("click") } !function (n) { n.fn.jqm = function (t) { return this.each(function () { var e = n(this).data("jqm") || n.extend({ ID: l++ }, n.jqm.params), o = n.extend(e, t); n(this).data("jqm", o).addClass("jqm-init")[0]._jqmID = o.ID, n(this).jqmAddTrigger(o.trigger) }) }, n.fn.jqmAddTrigger = function (e) { return e ? this.each(function () { r(n(this), "jqmShow", e) || t("jqmAddTrigger must be called on initialized modals") }) : void 0 }, n.fn.jqmAddClose = function (e) { return e ? this.each(function () { r(n(this), "jqmHide", e) || t("jqmAddClose must be called on initialized modals") }) : void 0 }, n.fn.jqmShow = function (t) { return this.each(function () { this._jqmShown || e(n(this), t) }) }, n.fn.jqmHide = function (t) { return this.each(function () { this._jqmShown && o(n(this), t) }) }; var t = function (n) { window.console && window.console.error && window.console.error(n) }, e = function (t, e) { e = e || window.event; var o = t.data("jqm"), i = parseInt(t.css("z-index")) || 3e3, a = n("<div></div>").addClass(o.overlayClass).css({ height: "100%", width: "100%", position: "fixed", left: 0, top: 0, "z-index": i - 1, opacity: o.overlay / 100 }), r = { w: t, c: o, o: a, t: e }; if (t.css("z-index", i), o.ajax) { var d = o.target || t, c = o.ajax; d = "string" == typeof d ? n(d, t) : n(d), "@" === c.substr(0, 1) && (c = n(e).attr(c.substring(1))), d.load(c, function () { o.onLoad && o.onLoad.call(this, r) }), o.ajaxText && d.html(o.ajaxText), s(r) } else s(r) }, o = function (n, t) { t = t || window.event; var e = n.data("jqm"), o = { w: n, c: e, o: n.data("jqmv"), t: t }; d(o) }, i = function (t) { return t.c.overlay > 0 && t.o.prependTo("body"), t.w.show(), n.jqm.focusFunc(t.w, !0), !0 }, a = function (n) { return n.w.hide() && n.o && n.o.remove(), !0 }, r = function (t, e, o) { var i = t.data("jqm"); return i ? n(o).each(function () { this[e] = this[e] || [], n.inArray(i.ID, this[e]) < 0 && (this[e].push(i.ID), n(this).click(function (n) { return n.isDefaultPrevented() || t[e](this), !1 })) }) : void 0 }, s = function (t) { var e = t.w, o = t.o, i = t.c; i.onShow(t) !== !1 && (e[0]._jqmShown = !0, i.modal ? (m[0] || c("bind"), m.push(e[0])) : e.jqmAddClose(o), i.closeClass && e.jqmAddClose(n("." + i.closeClass, e)), i.toTop && o && e.before('<span id="jqmP' + i.ID + '"></span>').insertAfter(o), e.data("jqmv", o), e.unbind("keydown", n.jqm.closeOnEscFunc), i.closeOnEsc && e.attr("tabindex", 0).bind("keydown", n.jqm.closeOnEscFunc).focus()) }, d = function (t) { var e = t.w, o = t.o, i = t.c; i.onHide(t) !== !1 && (e[0]._jqmShown = !1, i.modal && (m.pop(), m[0] || c("unbind")), i.toTop && o && n("#jqmP" + i.ID).after(e).remove()) }, c = function (t) { n(document)[t]("keypress keydown mousedown", u) }, u = function (t) { var e = n(t.target).data("jqm") || n(t.target).parents(".jqm-init:first").data("jqm"), o = m[m.length - 1]; return e && e.ID === o._jqmID ? !0 : n.jqm.focusFunc(o, t) }, l = 0, m = []; n.jqm = { params: { overlay: 50, overlayClass: "jqmOverlay", closeClass: "jqmClose", closeOnEsc: !1, trigger: ".jqModal", ajax: !1, target: !1, ajaxText: "", modal: !1, toTop: !1, onShow: i, onHide: a, onLoad: !1 }, focusFunc: function (t, e) { return e && n(":input:visible:first", t).focus(), !1 }, closeOnEscFunc: function (t) { return 27 === t.keyCode ? (n(this).jqmHide(), !1) : void 0 } } }(jQuery),
$(function () {
    var murl = window.location.href;    var seotitle = $("#sendemail").val();
    $("#sendContent").jqm({ ajax: "/html/ContactUs.aspx?t="+ seotitle + "&u="+murl, trigger: "a.sendcontact", overlay: "50" }), $("#services_modal").jqm({ ajax: "/html/SendEmail.html?t=" + +(new Date).valueOf(), trigger: "a.order", overlay: "50" })
}), $("a.jqmClose").bind("click", function () { $(".jqmWindow").jqmHide() });
//form
//function change(){var e=document.getElementById("eimg");e.src="/html/EnquiryCode.ashx?t="+(new Date).valueOf()}function service_change(){var e=document.getElementById("service_eimg");e.src="/html/ConpakOrderCode.ashx?t="+(new Date).valueOf()}function change_send(){var e=document.getElementById("send_cimg");e.src="/html/FormCode.ashx?t="+(new Date).valueOf()}function createLink(action_name){$.ajax({type:"GET",datatype:"json",url:"/api/share_city.ashx",data:{action:"GetCodeForVoice",method_type:action_name},success:function(data){function playEndedHandler(){myAudio.src=arr.pop(),myAudio.play(),!arr.length&&myAudio.removeEventListener("ended",playEndedHandler,!1)}if(""!=data){var code=eval("("+data+")").msg.split(""),arr=new Array;arr.push("/api/voice/cn/begin.mp3");for(var i=0;i<code.length;i++)arr.push("/api/voice/cn/"+code[i].trim()+".mp3");arr.push("/api/voice/cn/end.mp3"),arr=arr.reverse();var myAudio=new Audio;return myAudio.preload=!0,myAudio.controls=!0,myAudio.src=arr.pop(),myAudio.addEventListener("ended",playEndedHandler,!1),myAudio.play(),void(myAudio.loop=!1)}}})}$(function(){var e=$("#enForm").Validform({tiptype:function(e,t,a){var r=t.obj.parent().find(".Validform_checktip");a(r,t.type),r.text(e)},ajaxPost:!0,callback:function(t){"y"==t.status&&(change(),setTimeout(function(){e.resetForm()},2e3),setTimeout(function(){$.Hidemsg()},6e3))},datatype:{phone:function(e,t,a,r){return reg1=/^[+]{0,1}(\d){2,4}[ -]?(\d){2,4}[ -]?([ -]?(\d){3,12})+$/,reg1.test(e)?!0:!1}}});e.addRule([{ele:"#surname",datatype:"*1-10",nullmsg:"请输入姓氏",errormsg:"姓氏不少于2个字符"},{ele:"#name",datatype:"*1-10",nullmsg:"请输入名字",errormsg:"名字不少于2个字符"},{ele:".gender",datatype:"*",nullmsg:"请选择性別"},{ele:"#email",datatype:"e",nullmsg:"请输入电邮",errormsg:"电邮格式有误"},{ele:"#tel",datatype:"phone",nullmsg:"请输入电话",errormsg:"形如0755-88820088"},{ele:"#content",datatype:"*3-500",nullmsg:"3-500字符",errormsg:"3-500字符"},{ele:"#vcode",datatype:"s4-5",nullmsg:"请输入验证码",errormsg:"验证码错误"}])}),$(function(){var e=$("#ServiceForm").Validform({tiptype:function(e,t,a){var r=t.obj.parent().find(".Validform_checktip");a(r,t.type),r.text(e)},ajaxPost:!0,callback:function(e){$("#button").removeAttr("disabled"),"y"==e.status&&($(".sharp").hide(),$("#emailus").hide(),$(".complete").show())},beforeSubmit:function(e){$("#button").attr("disabled","disabled"),$(".sharp").show()},datatype:{phone:function(e,t,a,r){return reg1=/^\d{6,14}$/,reg1.test(e)?!0:!1}}});e.addRule([{ele:"#OTitle",datatype:"*1-10",nullmsg:"请输入标题",errormsg:"标题不少于2个字符"},{ele:"#OMsg",datatype:"*",nullmsg:"请输入内容",errormsg:"讯息不少于2个字符"},{ele:"#email",datatype:"e",nullmsg:"请输入电邮",errormsg:"电邮格式有误"},{ele:".gender",datatype:"*",nullmsg:"请选择称呼"},{ele:"#OUserName",datatype:"*1-10",nullmsg:"请输入姓名",errormsg:"名字不多于10个字符"},{ele:"#OTel",datatype:"phone",nullmsg:"请输入电话",errormsg:"形如88820088."},{ele:"#vcode",datatype:"s4-5",nullmsg:"请输入验证码",errormsg:"验证码为4位."}])}),$(function(){var e=$("#sendform").Validform({tiptype:function(e,t,a){if(t.obj.is("form")){var r=$("#showMsg");a(r,t.type),r.text(e)}else{var r=t.obj.parent().find(".Validform_checktip");a(r,t.type),r.text(e)}},showAllError:!0,ajaxPost:!0,callback:function(t){"y"==t.status&&setTimeout(function(){e.resetForm()},2e3)}});e.addRule([{ele:"#sname",datatype:"*2-10",nullmsg:"请输入发件人姓名",errormsg:"姓名不少于2个字符"},{ele:"#semail",datatype:"e",nullmsg:"请输入电邮",errormsg:"电邮格式有误"},{ele:"#yname",datatype:"*2-10",nullmsg:"请输入您的姓名",errormsg:"姓名不少于2个字符"},{ele:"#yemail",datatype:"e",nullmsg:"请输入电邮",errormsg:"电邮格式有误"},{ele:"#vCode",datatype:"s4-4",nullmsg:"请输入验证码",errormsg:"验证码为4位字符"}])}),$(".cp-contact-list>h4").click(function(){$(this).nextAll("dl").toggle(),$(this).toggleClass("h-active"),$(this).children().toggleClass("h-active")});
/////////////////////////////////表单咨询///////////////////////////////////////
$(function () {
    var enForm = $("#enForm").Validform({
        tiptype: function (msg, o, cssctl) {
            if (!o.obj.is("form")) {
                var objtip = o.obj.parent().find(".Validform_checktip");
                cssctl(objtip, o.type);
                objtip.text(msg);
            } else {
                var objtip = $("#showMsg");
                cssctl(objtip, o.type);
                objtip.text(msg);
            }
        },
        // showAllError: true,
        ajaxPost: true,
        callback: function (data) {
            if (data.status == "y") {
                $("#showMsg").text("感谢您的咨询，我们会尽快与您联络！");//.attr("style", "text-indent:0;");
                change();
                setTimeout(function () {
                    enForm.resetForm(); 
                    $("#showMsg").text("");
                }, 5000); 
            }
        },
        datatype: {
            "phone": function (gets, obj, curform, regxp) {
                reg1 = /^[+]{0,1}(\d){2,4}[ -]?(\d){2,4}[ -]?([ -]?(\d){3,12})+$/
                if (reg1.test(gets)) { return true; }
                return false;
            },
	"zh1-10":/^[a-zA-Z\u4e00-\u9fa5 ]{1,10}$/
        }
    });
    enForm.addRule([
        {
            ele: "#surname",
            datatype: "zh1-10",
            nullmsg: "请输入姓氏",
            errormsg: "姓氏不少于2个字符"
        },
        {
            ele: "#name",
            datatype: "zh1-10",
            nullmsg: "请输入名字",
            errormsg: "名字不少于2个字符"
        },
        {
            ele: ".gender",
            datatype: "*",
            nullmsg: "请选择性別"
        },
        {
            ele: "#email",
            datatype: "e",
            nullmsg: "请输入电邮",
            errormsg: "电邮格式有误"
        },
        {
            ele: "#tel",
            datatype: "phone",
            nullmsg: "请输入电话",
            errormsg: "如+86 755 8882 0088"
        },
        {
            ele: "#content",
            datatype: "s3-500",
            nullmsg: "请输入咨询内容",
            errormsg: "3-500字符"
        },
        {
            ele: "#vcode",
            datatype: "s4-5",
            nullmsg: "请输入验证码",
            errormsg: "验证码错误"
        }
    ]);
    //enForm.tipmsg.p = '<img src="../images/bedeck/onLoad.gif"/>正在提交咨询，请稍后...';
});

function change() {
    var imgNode = document.getElementById("eimg");
    imgNode.src = "/html/EnquiryCode.ashx?t=" + (new Date()).valueOf();
}

/////////////////////////////////邮件咨询///////////////////////////////////////
$(function () {
    var ServiceForm = $("#ServiceForm").Validform({
        tiptype: function (msg, o, cssctl) {
            if (!o.obj.is("form")) {
                var objtip = o.obj.parent().find(".Validform_checktip");
                cssctl(objtip, o.type);
                objtip.text(msg);
            } else {
                var objtip = $("#showSendEmailMsg");
                cssctl(objtip, o.type);
                objtip.text(msg);
            }
        },
        // showAllError: true,
        ajaxPost: true,
        callback: function (data) {
            $('#button').removeAttr("disabled");
            if (data.status == "y") { 
                $("#showSendEmailMsg").text("感谢您的咨询，我们会尽快与您联系！");//.attr("style", "text-indent:0;");
                service_change();
                setTimeout(function () {
                    ServiceForm.resetForm(); 
                    $("#showSendEmailMsg").text("");
                }, 5000);
            }
        }, beforeSubmit: function (curform) {
            $('#button').attr('disabled', "disabled");
            $(".sharp").show();
        }, datatype: {
            "phone": function (gets, obj, curform, regxp) {
                reg1 = /^[+]{0,1}(\d){2,4}[ -]?(\d){2,4}[ -]?([ -]?(\d){3,12})+$/
                if (reg1.test(gets)) { return true; }
                return false;
            },
	"zh1-10":/^[a-zA-Z\u4e00-\u9fa5 ]{1,10}$/
        }
    });
    ServiceForm.addRule([
        {
            ele: "#OTitle",
            datatype: "s1-10",
            nullmsg: "请输入标题",
            errormsg: "标题不少于2个字符"
        },
        {
            ele: "#OMsg",
            datatype: "*",
            nullmsg: "请输入内容",
            errormsg: "讯息不少于2个字符"
        },
        {
            ele: "#email",
            datatype: "e",
            nullmsg: "请输入电邮",
            errormsg: "电邮格式有误"
        },
         {
             ele: ".gender",
             datatype: "*",
             nullmsg: "请选择称呼"
         },
        {
            ele: "#OUserName",
            datatype: "zh1-10",
            nullmsg: "请输入姓名",
            errormsg: "名字不多于10个字符"
        },
         {
             ele: "#OTel",
             datatype: "phone",
             nullmsg: "请输入电话",
             errormsg: "如+86 755 8882 0088."
         },
        {
            ele: "#vcode",
            datatype: "s4-5",
            nullmsg: "请输入验证码",
            errormsg: "验证码为4位."
        }
    ]);
    //ServiceForm.tipmsg.p = '<img src="../images/bedeck/onLoad.gif"/>正在提交咨询，请稍后...';
});

function service_change() {
    var imgNode = document.getElementById("service_eimg");
    imgNode.src = "/html/ConpakOrderCode.ashx?t=" + (new Date()).valueOf();
}

/////////////////////////////////联络我们//////////////////////////////$(function () {
    var sendFo = $("#sendform").Validform({
        tiptype: function (msg, o, cssctl) {
            if (!o.obj.is("form")) {
                var objtip = o.obj.parent().find(".Validform_checktip");
                cssctl(objtip, o.type);
                objtip.text(msg);
            } else {
                var objtip = $("#showConpakMsg");
                cssctl(objtip, o.type);
                objtip.text(msg);
            }
        },
        //showAllError: true,
        ajaxPost: true,
        callback: function (data) {
            if (data.status == "y") {
                $("#showConpakMsg").text(data.info);//.attr("style", "text-indent:0;");
                change_send();
                setTimeout(function () {
                    sendFo.resetForm();$("#showConpakMsg").text("");
                }, 5000);
            }
        },
	datatype: {
		"zh1-10":/^[a-zA-Z\u4e00-\u9fa5 ]{1,10}$/
		}
    });
    sendFo.addRule([
        {
            ele: "#sname",
            datatype: "zh1-10",
            nullmsg: "请输入发件人姓名",
            errormsg: "姓名不少于2个字符"
        },
        {
            ele: "#semail",
            datatype: "e",
            nullmsg: "请输入电邮",
            errormsg: "电邮格式有误"
        },
        {
            ele: "#yname",
            datatype: "zh1-10",
            nullmsg: "请输入姓名",
            errormsg: "姓名不少于2个字符"
        },
        {
            ele: "#yemail",
            datatype: "e",
            nullmsg: "请输入电邮",
            errormsg: "电邮格式有误"
        },
      {
          ele: "#vCode",
          datatype: "s4-4",
          nullmsg: "请输入验证码",
          errormsg: "验证码为4位字符"
      }
    ]);
    //sendFo.tipmsg.p = '正在提交，请稍后...';
});

//语音控制
function OpenVoice(Code) {
    var code = Code.split('');
    var arr = new Array();
    arr.push("http://www.conpak.com.cn/api/voice/cn/begin.mp3");
    for (var i = 0; i < code.length; i++) {
        arr.push("http://www.conpak.com.cn/api/voice/cn/" + code[i].trim() + ".mp3");
    }
    arr.push("http://www.conpak.com.cn/api/voice/cn/end.mp3");
    arr = arr.reverse();//把需要播放的歌曲从后往前排 

    var AuditShow = document.createElement('div');
    AuditShow.setAttribute('style', 'display:none;');
    var myAudio = document.createElement('audio');
    myAudio.preload = true;
    myAudio.controls = true;
    myAudio.src = arr.pop();//每次读数组最后一个元素
    myAudio.addEventListener('ended', playEndedHandler, false);
    myAudio.play();
    myAudio.loop = false;//禁止循环，否则无法触发ended事件
    function playEndedHandler() {
        myAudio.src = arr.pop();
        myAudio.play();
        !arr.length && myAudio.removeEventListener('ended', playEndedHandler, false);//只有一个元素时解除绑定
    }
    AuditShow.appendChild(myAudio);
    document.body.appendChild(AuditShow); //把它添加到页面中
}

function createLink(action_name) {
    $.ajax({
        type: "GET",
        datatype: 'json',
        async: false,
        url: "/api/share_city.ashx",
        data: { action: "GetCodeForVoice", method_type: action_name },
        success: function (data) {
            if (data != "") {
                OpenVoice(eval("(" + data + ")").msg);
            }
        }
    });
}
$(".cp-contact-list>h4").click(function(){$(this).nextAll("dl").toggle(),$(this).toggleClass("h-active"),$(this).children().toggleClass("h-active")});